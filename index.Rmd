---
title: "Golasecca"
author: "V. Cicolani, T. Huet"
date: "11/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# library(XLConnect)
library(igraph)
# library(network)
library(ggplot2)
library(plotly)
map1.url <- "https://qgiscloud.com/VGChilde/gic_iiab"
publi.url <- "https://halshs.archives-ouvertes.fr/halshs-02314978/document"
```

## Golasecca IC-IIAB

### Carte

[Golasecca IC IIAB](https://qgiscloud.com/VGChilde/gic_iiab) 

Plus courts chemins et carrefours intersites théoriques pour la
période Golasecca IC-IIAB, entre 670 et 530 av. J.-C.
Les numéros des cols renvoient à la fig. 2.
PAO Thomas Huet. Données Veronica Cicolani.
... during the period 

### Graph

Distribution en Suisse de la parure Golasecca et de la vaisselle
métallique (étrusque et de Grande Grèce) par type de site pour la période
Golasecca IC-IIAB, entre 670 et 530 avant J.-C.

```{r pressure, echo=FALSE}
chm <-"F:\\Collaborations et concours\\Colloques, seminaires, articles\\170427 CTHS\\data_12.xlsx"
# tableau 1
# data <- readWorksheetFromFile(chm,
#                               sheet = "europe-ceramiques",
#                               region = "G1:H522",
#                               header = TRUE)
data <- openxlsx::read.xlsx(chm,
                            sheet = "europe-ceramiques",
                            cols = c(7,8),
                            # region = "G1:H522",
                            colNames  = TRUE)
colnames(data)[1] <- 'sites'
colnames(data)[2] <- 'objets'
# tableau 2
# chrono <- readWorksheetFromFile(chm,
#                                 sheet = "europe-ceramiques",
#                                 region = "Y1:AB522",
#                                 header = TRUE)
chrono <- openxlsx::read.xlsx(chm,
                                sheet = "europe-ceramiques",
                              cols = c(25,26,27,28),
                              colNames = TRUE)
chrono <- chrono[-nrow(chrono),] # rm ccalcultaed sums
colnames(chrono)[1] <- 'GIC_IIAB'
colnames(chrono)[2] <- 'GIIAB_IIIA1'
colnames(chrono)[3] <- 'GIIIA1_IIIA3'
colnames(chrono)[4] <- 'GIIIA3'
# associe les tableaux
tab <- cbind(data,chrono) 

# période 1
f.a.period <- function(a.per){
  # a.per <- "GIC_IIAB"
  per <- tab[tab[,a.per] > 0,]
  per <- per[complete.cases(per),]
  per <- subset(per, select=c("sites","objets",a.per))
  # GIC_IIAB$GIIAB_IIIA1 <- NULL
  # GIC_IIAB$GIIIA1_IIIA3 <- NULL
  # GIC_IIAB$GIIIA3 <- NULL
  return(per)
}
df.per <- f.a.period("GIC_IIAB")

# graphe
g <- graph_from_data_frame(df.per, directed = FALSE, vertices = NULL)
plot(g,vertex.size = 3,layout = layout.fruchterman.reingold)
# gp <- ggplotly(g)
# htmlwidgets::saveWidget(as_widget(gp), "ggplot.html")
# plot_ly(p)
```

## References

[Bib](https://halshs.archives-ouvertes.fr/halshs-02314978/document)
